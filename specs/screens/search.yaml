version: "2.0"
date: "2026-02-12"

screen:
  name: 검색 결과 페이지
  route: /search
  file: frontend/pages/search.vue

purpose:
  description: 키워드, 카테고리, 위치 기반으로 시설을 검색하고 결과를 목록/지도 뷰로 표시. 쓰레기 카테고리는 별도 UI 제공
  userGoals:
    - 검색 조건으로 주변 시설 찾기
    - 목록과 지도에서 시설 위치 확인
    - 필터링 및 정렬로 원하는 시설 찾기
    - 쓰레기 배출 일정 조회 (trash 카테고리)

layouts:
  mobile:
    breakpoint: "< 768px"
    sections:
      - mobileHeader
      - categoryChips
      - resultsList
      - mobileFAB
      - mobileMapOverlay (토글)
  desktop:
    breakpoint: ">= 768px"
    sections:
      - desktopHeader
      - splitView (목록 + 지도)

sections:
  mobileHeader:
    name: 모바일 헤더
    elements:
      - 뒤로가기 버튼
      - 검색 입력창 (실시간 검색)
      - 필터/정렬 아이콘 버튼
      - 정렬 드롭다운 (거리순/이름순)

  categoryChips:
    name: 카테고리 필터 칩
    elements:
      - 가로 스크롤 칩 목록 (전체 + 8개 카테고리)
      - 선택된 카테고리 하이라이트
      - CategoryIcon 컴포넌트

  resultsList:
    name: 검색 결과 목록
    elements:
      - 시설 카드 (FacilityCard 스타일)
      - 각 카드: 아이콘, 이름, 주소, 거리, 운영 상태
      - 로딩 상태
      - 빈 상태 (결과 없음)
      - "더 보기" 버튼 (페이지네이션)

  trashCategoryUI:
    name: 쓰레기 카테고리 전용 UI
    elements:
      - 지역 선택 드롭다운 (시/도, 구/군)
      - 동/지역 이름 검색 입력창
      - 담당 부서 연락처 표시
      - WasteScheduleCard 컴포넌트로 배출 일정 표시

  mobileFAB:
    name: 모바일 플로팅 버튼
    elements:
      - "지도에서 보기" / "목록 보기" 토글 버튼
      - 하단 중앙 고정 위치

  mobileMapOverlay:
    name: 모바일 전체화면 지도 오버레이
    elements:
      - FacilityMap 컴포넌트
      - 닫기 버튼
      - 지도 컨트롤 (현재 위치, 줌 인/아웃)

  desktopHeader:
    name: 데스크톱 헤더
    elements:
      - 검색 입력창 (좌측)
      - 카테고리 탭 (pill 스타일, 우측)
      - 북마크 버튼

  splitView:
    name: 분할 뷰 (데스크톱)
    elements:
      - 좌측 사이드바: 결과 목록 + 필터
      - 우측 지도: FacilityMap 컴포넌트
      - 지도 컨트롤 (현재 위치, 줌)

state:
  composables:
    - name: useFacilitySearch
      usage: 시설 검색 로직 (검색, 페이지네이션, 정렬)
    - name: useGeolocation
      usage: 사용자 현재 위치 가져오기
    - name: useWasteSchedule
      usage: 쓰레기 배출 일정 조회 (trash 카테고리)
    - name: useFacilityMeta
      usage: 검색 페이지 SEO 메타태그 설정
    - name: useStructuredData
      usage: ItemList JSON-LD 구조화 데이터
  data:
    - searchKeyword (ref<string>): 검색 키워드
    - selectedCategory (ref<FacilityCategory | 'all'>): 선택된 카테고리
    - selectedSort (ref<'distance' | 'name'>): 정렬 기준
    - selectedFacilityId (ref<string | null>): 선택된 시설 ID
    - showMobileMap (ref<boolean>): 모바일 지도 표시 여부
    - userLocation (ref<{lat, lng} | null>): 사용자 위치
    - mapBounds (ref): 지도 영역 정보
    - wasteSchedules (ref<RegionSchedule[]>): 쓰레기 배출 일정 (trash 전용)

handlers:
  handleSearch:
    trigger: 검색창 Enter 또는 검색어 변경
    action: performSearch() 호출, 페이지 1로 리셋
  handleCategoryChange:
    trigger: 카테고리 칩/탭 클릭
    action: 카테고리 변경 후 검색, trash인 경우 지역 선택 UI 표시
  handleFacilitySelect:
    trigger: 시설 카드 클릭
    action: /{category}/{id} 상세 페이지로 이동
  handleLocationFound:
    trigger: 현재 위치 버튼 클릭 성공
    action: userLocation 설정 후 위치 기반 검색
  handleMapBoundsChanged:
    trigger: 지도 이동/줌 변경
    action: 지도 영역 기반 검색 (디바운스 300ms)
  toggleMobileMap:
    trigger: 모바일 FAB 클릭
    action: 지도/목록 뷰 토글

seo:
  title: "{keyword} 검색 결과 - 일상킷" (동적)
  description: "{keyword} 주변의 {category} 정보를 확인하세요" (동적)
  structuredData: ItemList schema (검색 결과), 페이지네이션 link 태그

dataRequirements:
  - resource: 시설 검색 결과
    endpoint: /api/facilities/search
    params: [keyword, category, lat, lng, swLat, swLng, neLat, neLng, page, limit]
    via: useFacilitySearch.search()
  - resource: 쓰레기 배출 일정
    endpoint: /api/waste-schedules
    params: [city, district, keyword]
    via: useWasteSchedule.getSchedules()
