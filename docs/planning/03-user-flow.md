# 03. 사용자 흐름도 (User Flow)

## 주요 사용자 시나리오

### 시나리오 1: 검색엔진 유입 (Primary)
```
Google 검색 "강남역 공공화장실"
           │
           ▼
┌─────────────────────────┐
│ 일상킷 지역별 페이지     │
│ /seoul/gangnam/toilet   │
│                         │
│ - 강남구 화장실 목록     │
│ - 지도 표시             │
│ - SEO 최적화            │
└─────────────────────────┘
           │
           ▼
┌─────────────────────────┐
│ 상세 페이지 클릭        │
│ /toilet/12345          │
│                         │
│ - 상세 정보 확인        │
│ - 길찾기 연결           │
└─────────────────────────┘
```

### 시나리오 2: 직접 방문 검색
```
일상킷 메인 페이지 방문
           │
           ▼
┌─────────────────────────┐
│ 메인 페이지             │
│ /                       │
│                         │
│ - 검색창 (중앙)         │
│ - 카테고리 선택         │
│ - 현재 위치 버튼        │
└─────────────────────────┘
           │
     검색어 입력 + 검색
           │
           ▼
┌─────────────────────────┐
│ 검색 결과 페이지        │
│ /search?q=화장실        │
│                         │
│ - 목록 뷰 (기본)        │
│ - 지도 뷰 (토글)        │
│ - 필터 (카테고리/거리)  │
└─────────────────────────┘
           │
     결과 항목 클릭
           │
           ▼
┌─────────────────────────┐
│ 상세 페이지             │
│ /toilet/12345          │
│                         │
│ - 시설 정보             │
│ - 지도 (단일 마커)      │
│ - 길찾기 링크           │
└─────────────────────────┘
```

### 시나리오 3: 현재 위치 기반 검색
```
메인 페이지
           │
     "현재 위치" 버튼 클릭
           │
           ▼
┌─────────────────────────┐
│ 위치 권한 요청          │
│ (브라우저 팝업)         │
└─────────────────────────┘
           │
     권한 허용
           │
           ▼
┌─────────────────────────┐
│ 주변 시설 검색 결과     │
│ /search?lat=37.5&lng=127│
│                         │
│ - 지도 뷰 (기본)        │
│ - 거리순 정렬           │
│ - 카테고리 필터         │
└─────────────────────────┘
```

---

## 반응형 UI 가이드

### Mobile vs Desktop 레이아웃 비교

#### 메인 페이지

```
┌─ Mobile (< 640px) ──────┐    ┌─ Desktop (> 1024px) ──────────────────┐
│                         │    │                                        │
│      일상킷             │    │          일상킷                         │
│  내 주변 생활 편의 정보  │    │     내 주변 생활 편의 정보              │
│                         │    │                                        │
│  ┌───────────────────┐  │    │     ┌───────────────────────────┐     │
│  │ 🔍 검색어 입력... │  │    │     │  🔍 검색어 입력...    [검색] │     │
│  └───────────────────┘  │    │     └───────────────────────────┘     │
│                         │    │                                        │
│  ← 🚻 🗑️ 📶 👕 🔋 🏧 → │    │   ┌────┐ ┌────┐ ┌────┐ ┌────┐        │
│  (가로 스크롤)           │    │   │🚻  │ │🗑️  │ │📶  │ │👕  │ ...    │
│                         │    │   │화장실│ │쓰레기│ │와이파이│ │의류  │     │
│  ┌───────────────────┐  │    │   └────┘ └────┘ └────┘ └────┘        │
│  │ 📍 현재 위치 검색  │  │    │     (그리드 레이아웃)                  │
│  └───────────────────┘  │    │                                        │
│                         │    │     [📍 현재 위치로 검색]              │
│  인기 지역               │    │                                        │
│  서울 부산 대구 인천 ...  │    │     인기 지역: 서울 | 부산 | 대구 | ... │
│  (가로 스크롤)           │    │                                        │
└─────────────────────────┘    └────────────────────────────────────────┘
```

#### 검색 결과 페이지

```
┌─ Mobile (< 640px) ──────┐    ┌─ Desktop (> 1024px) ─────────────────────────────┐
│ ← 🔍 "강남 화장실"      │    │ ← 일상킷   🔍 "강남 화장실"            [검색]    │
├─────────────────────────┤    ├─────────────────────────────────────────────────┤
│ [목록 🔘] [지도 ○]      │    │                                                 │
│                         │    │  ┌─────────────────┬───────────────────────┐   │
│ ┌───────────────────┐   │    │  │                 │                       │   │
│ │🚻 강남역 공중화장실│   │    │  │ [목록] [지도]   │      🚻               │   │
│ │  강남대로 396      │   │    │  │ 45건 검색      │   🚻     🚻           │   │
│ │  120m              │   │    │  │                │      📍               │   │
│ └───────────────────┘   │    │  │ ┌───────────┐  │         🚻            │   │
│                         │    │  │ │🚻 강남역  │  │   🚻                  │   │
│ ┌───────────────────┐   │    │  │ │  120m     │  │                       │   │
│ │🚻 신논현역 화장실  │   │    │  │ └───────────┘  │                       │   │
│ │  봉은사로...       │   │    │  │                │                       │   │
│ │  350m              │   │    │  │ ┌───────────┐  │                       │   │
│ └───────────────────┘   │    │  │ │🚻 신논현역│  │                       │   │
│                         │    │  │ │  350m     │  │                       │   │
│ ... (스크롤)            │    │  │ └───────────┘  │                       │   │
│                         │    │  │                │                       │   │
│ ─────────────────────── │    │  │ ... (스크롤)   │                       │   │
│ [🗺️ 지도에서 보기]      │    │  └─────────────────┴───────────────────────┘   │
│ (하단 고정 버튼)        │    │  (좌측 목록 + 우측 지도 2컬럼 분할)              │
└─────────────────────────┘    └─────────────────────────────────────────────────┘
```

#### 상세 페이지

```
┌─ Mobile (< 640px) ──────┐    ┌─ Desktop (> 1024px) ─────────────────────────────┐
│ ← 강남역 공중화장실     │    │ ← 뒤로   강남역 공중화장실                        │
├─────────────────────────┤    ├─────────────────────────────────────────────────┤
│ ┌───────────────────┐   │    │                                                 │
│ │      🚻           │   │    │  ┌───────────────────┬───────────────────────┐ │
│ │     (지도)        │   │    │  │                   │                       │ │
│ │     180px         │   │    │  │ 📍 강남대로 396   │         🚻            │ │
│ └───────────────────┘   │    │  │ 🕐 24시간 운영   │       (지도)          │ │
│                         │    │  │ 📞 02-1234-5678  │        360px          │ │
│ 📍 서울시 강남구        │    │  │                   │                       │ │
│    강남대로 396         │    │  │ ─────────────── │                       │ │
│ 🕐 24시간 운영          │    │  │ 시설 정보        │                       │ │
│                         │    │  │ ─────────────── │                       │ │
│ ─────────────────────── │    │  │ 여자: 5칸        │                       │ │
│ 시설 정보               │    │  │ 남자: 3칸        │                       │ │
│ ─────────────────────── │    │  │ 장애인: 있음 ✅  │                       │ │
│ 여자 화장실: 5칸        │    │  │ ...              │                       │ │
│ 남자 화장실: 3칸        │    │  │                   │                       │ │
│ 장애인: 있음 ✅          │    │  │ ┌─────────────┐ │                       │ │
│ ...                     │    │  │ │ 📍 길찾기   │ │                       │ │
│                         │    │  │ └─────────────┘ │                       │ │
│ ┌───────────────────┐   │    │  └───────────────────┴───────────────────────┘ │
│ │    📍 길찾기       │   │    │  (좌측 정보 + 우측 지도)                        │
│ └───────────────────┘   │    │                                                 │
│ (하단 고정 버튼)        │    └─────────────────────────────────────────────────┘
└─────────────────────────┘
```

### 터치 인터랙션 고려사항

| 요소 | 최소 크기 | 간격 | 이유 |
|------|----------|------|------|
| 버튼 | 44x44px | 8px | Apple HIG 권장 |
| 카드 탭 영역 | 전체 영역 | - | 쉬운 탭 |
| 카테고리 칩 | 44px 높이 | 8px | 손가락 크기 |
| 지도 마커 | 40x40px | - | 정밀 탭 가능 |
| 뒤로가기 | 44x44px | - | 엄지 접근성 |

### 스와이프/제스처

| 제스처 | 위치 | 동작 |
|--------|------|------|
| 가로 스와이프 | 카테고리 칩 | 카테고리 스크롤 |
| 아래로 당기기 | 검색 결과 | 새로고침 (PTR) |
| 위로 스와이프 | 하단 지도 토글 | 지도 확장 (Sheet) |

---

## 페이지별 상세 흐름

### 1. 메인 페이지 (/)

```
┌────────────────────────────────────────────┐
│                 일상킷                      │
│        내 주변 생활 편의 정보               │
│                                            │
│  ┌────────────────────────────────────┐   │
│  │  🔍 검색어 입력...          [검색]  │   │
│  └────────────────────────────────────┘   │
│                                            │
│  ┌──────┐ ┌──────┐ ┌──────┐              │
│  │🚻    │ │🗑️    │ │📶    │              │
│  │화장실│ │쓰레기│ │와이파이│              │
│  └──────┘ └──────┘ └──────┘              │
│                                            │
│  [📍 현재 위치로 검색]                     │
│                                            │
│  ─────────────────────────────────────    │
│  인기 지역                                 │
│  서울 | 부산 | 대구 | 인천 | ...           │
└────────────────────────────────────────────┘
```

**사용자 액션:**
- 검색어 입력 → 검색 결과 페이지
- 카테고리 클릭 → 해당 카테고리 검색 결과
- 현재 위치 버튼 → 위치 권한 요청 → 주변 검색
- 지역 클릭 → 지역별 페이지

---

### 2. 검색 결과 페이지 (/search)

```
┌────────────────────────────────────────────┐
│ ← 일상킷    🔍 "강남 화장실"       [검색]  │
├────────────────────────────────────────────┤
│ 필터: [전체▾] [거리순▾] [500m▾]           │
├────────────────────────────────────────────┤
│ [목록] [지도]                    45건 검색  │
├────────────────────────────────────────────┤
│                                            │
│ ┌────────────────────────────────────────┐│
│ │ 🚻 강남역 공중화장실              120m ││
│ │    서울시 강남구 강남대로 396          ││
│ │    24시간 운영                         ││
│ └────────────────────────────────────────┘│
│                                            │
│ ┌────────────────────────────────────────┐│
│ │ 🚻 신논현역 공중화장실            350m ││
│ │    서울시 강남구 봉은사로 ...          ││
│ │    06:00~23:00                         ││
│ └────────────────────────────────────────┘│
│                                            │
│ ... (더 보기)                              │
└────────────────────────────────────────────┘
```

**지도 뷰:**
```
┌────────────────────────────────────────────┐
│ [목록] [지도]                    45건 검색  │
├────────────────────────────────────────────┤
│                                            │
│    ┌─────────────────────────────────┐    │
│    │         🚻                      │    │
│    │    🚻       🚻                  │    │
│    │         📍                      │    │
│    │              🚻                 │    │
│    │    🚻                           │    │
│    └─────────────────────────────────┘    │
│                                            │
│ ┌────────────────────────────────────────┐│
│ │ 🚻 강남역 공중화장실              120m ││
│ │    (마커 클릭 시 표시)                 ││
│ └────────────────────────────────────────┘│
└────────────────────────────────────────────┘
```

---

### 3. 상세 페이지 (카테고리별)

> **전략**: 카테고리별로 다른 상세 정보를 표시. details JSON에서 필요한 필드만 추출하여 표시하고, null/undefined 필드는 숨김 처리.

#### 3-1. 공공화장실 (/toilet/:id)

```
┌────────────────────────────────────────────┐
│ ← 뒤로    강남역 공중화장실                 │
├────────────────────────────────────────────┤
│                                            │
│    ┌─────────────────────────────────┐    │
│    │              🚻                 │    │
│    │         (지도)                  │    │
│    └─────────────────────────────────┘    │
│                                            │
│  📍 서울시 강남구 강남대로 396              │
│  🕐 24시간 운영                            │
│  📞 02-1234-5678                          │
│                                            │
│  ─────────────────────────────────────    │
│  시설 정보                                 │
│  ─────────────────────────────────────    │
│  여자 화장실: 5칸                          │
│  남자 화장실: 3칸                          │
│  남녀공용 화장실: 1칸                       │
│  장애인 화장실: 있음 ✅                     │
│  어린이 화장실: 없음                        │
│  기저귀 교환대: 있음 ✅                     │
│  비상벨: 있음 ✅                           │
│                                            │
│  ─────────────────────────────────────    │
│  위치 안내                                 │
│  ─────────────────────────────────────    │
│  역사 내 1번 출구 옆 (지하1층)              │
│                                            │
│  ┌────────────────────────────────────┐   │
│  │         [📍 길찾기]                │   │
│  └────────────────────────────────────┘   │
└────────────────────────────────────────────┘
```

#### 3-2. 쓰레기 배출 (/trash/:id)

```
┌────────────────────────────────────────────┐
│ ← 뒤로    강남대로 일반쓰레기 배출          │
├────────────────────────────────────────────┤
│                                            │
│    ┌─────────────────────────────────┐    │
│    │              🗑️                │    │
│    │         (지도)                  │    │
│    └─────────────────────────────────┘    │
│                                            │
│  📍 서울시 강남구 강남대로 일대             │
│  📞 02-1234-5678 (환경과)                 │
│                                            │
│  ─────────────────────────────────────    │
│  배출 정보                                 │
│  ─────────────────────────────────────    │
│  쓰레기 종류: 일반쓰레기                    │
│  배출 방법: 종량제봉투                      │
│  수거 요일: 월, 수, 금                      │
│  배출 시간: 20:00 ~ 익일 06:00             │
│                                            │
│  ─────────────────────────────────────    │
│  참고 사항                                 │
│  ─────────────────────────────────────    │
│  음식물쓰레기는 별도 배출                   │
│                                            │
│  ┌────────────────────────────────────┐   │
│  │         [📍 길찾기]                │   │
│  └────────────────────────────────────┘   │
└────────────────────────────────────────────┘
```

#### 3-3. 무료 와이파이 (/wifi/:id)

```
┌────────────────────────────────────────────┐
│ ← 뒤로    강남역 무료 와이파이              │
├────────────────────────────────────────────┤
│                                            │
│    ┌─────────────────────────────────┐    │
│    │              📶                 │    │
│    │         (지도)                  │    │
│    └─────────────────────────────────┘    │
│                                            │
│  📍 서울시 강남구 강남대로 지하 396         │
│  🌐 SSID: Seoul_Free_WiFi                 │
│                                            │
│  ─────────────────────────────────────    │
│  와이파이 정보                              │
│  ─────────────────────────────────────    │
│  보안 유형: OPEN (비밀번호 없음)            │
│  속도 등급: 고속                           │
│  서비스 제공: KT                           │
│  설치일: 2023-01-15                        │
│  운영 상태: 운영중 ✅                       │
│                                            │
│  ─────────────────────────────────────    │
│  위치 안내                                 │
│  ─────────────────────────────────────    │
│  지하철 역사 내 (3번 출구 옆)               │
│                                            │
│  ┌────────────────────────────────────┐   │
│  │         [📍 길찾기]                │   │
│  └────────────────────────────────────┘   │
└────────────────────────────────────────────┘
```

#### 3-4. 의류수거함 (/clothes/:id)

```
┌────────────────────────────────────────────┐
│ ← 뒤로    래미안아파트 의류수거함           │
├────────────────────────────────────────────┤
│                                            │
│    ┌─────────────────────────────────┐    │
│    │              👕                 │    │
│    │         (지도)                  │    │
│    └─────────────────────────────────┘    │
│                                            │
│  📍 서울시 강남구 도곡로 123                │
│  📞 02-1234-5678                          │
│                                            │
│  ─────────────────────────────────────    │
│  수거함 정보                               │
│  ─────────────────────────────────────    │
│  관리번호: CLT-2024-001                    │
│  수거 주기: 주 1회                          │
│  설치일: 2023-06-01                        │
│                                            │
│  ─────────────────────────────────────    │
│  수거 가능 품목                             │
│  ─────────────────────────────────────    │
│  ✅ 의류  ✅ 신발  ✅ 가방                  │
│  ❌ 속옷, 양말 등 제외                      │
│                                            │
│  ┌────────────────────────────────────┐   │
│  │         [📍 길찾기]                │   │
│  └────────────────────────────────────┘   │
└────────────────────────────────────────────┘
```

#### 3-5. 폐형광등/폐건전지 (/battery/:id)

```
┌────────────────────────────────────────────┐
│ ← 뒤로    래미안아파트 폐형광등수거함       │
├────────────────────────────────────────────┤
│                                            │
│    ┌─────────────────────────────────┐    │
│    │              🔋                 │    │
│    │         (지도)                  │    │
│    └─────────────────────────────────┘    │
│                                            │
│  📍 서울시 강남구 도곡로 123                │
│  📞 02-1234-5678                          │
│                                            │
│  ─────────────────────────────────────    │
│  수거함 정보                               │
│  ─────────────────────────────────────    │
│  수거 품목: 폐형광등, 폐건전지              │
│  수거함 수량: 2개                          │
│  위치: 옥외 (관리사무소 앞)                 │
│  수거 주기: 월 2회                          │
│  최근 수거일: 2024-01-15                   │
│                                            │
│  ┌────────────────────────────────────┐   │
│  │         [📍 길찾기]                │   │
│  └────────────────────────────────────┘   │
└────────────────────────────────────────────┘
```

#### 3-6. 무인민원발급기 (/kiosk/:id)

```
┌────────────────────────────────────────────┐
│ ← 뒤로    강남구청 무인민원발급기           │
├────────────────────────────────────────────┤
│                                            │
│    ┌─────────────────────────────────┐    │
│    │              🏧                 │    │
│    │         (지도)                  │    │
│    └─────────────────────────────────┘    │
│                                            │
│  📍 서울시 강남구 학동로 426 (1층 민원실)   │
│  📞 02-1234-5678                          │
│                                            │
│  ─────────────────────────────────────    │
│  운영시간                                  │
│  ─────────────────────────────────────    │
│  평일: 09:00 ~ 18:00                       │
│  토요일: 09:00 ~ 13:00                     │
│  공휴일: 휴무                               │
│                                            │
│  ─────────────────────────────────────    │
│  발급 가능 서류                             │
│  ─────────────────────────────────────    │
│  주민등록등본, 가족관계증명서, 인감증명서    │
│                                            │
│  ─────────────────────────────────────    │
│  장애인 편의시설                            │
│  ─────────────────────────────────────    │
│  시각장애인 점자키패드: ✅                  │
│  음성 안내: ✅                              │
│  점자 안내: ✅                              │
│  휠체어 접근: ✅                            │
│  엘리베이터: ✅                             │
│  장애인 화장실: ❌                          │
│  주차 가능: ✅                              │
│                                            │
│  ┌────────────────────────────────────┐   │
│  │         [📍 길찾기]                │   │
│  └────────────────────────────────────┘   │
└────────────────────────────────────────────┘
```

---

### 4. 지역별 페이지 (/seoul/gangnam/toilet)

```
┌────────────────────────────────────────────┐
│ 일상킷 > 서울 > 강남구 > 공공화장실         │
├────────────────────────────────────────────┤
│                                            │
│  강남구 공공화장실 45곳                     │
│                                            │
│  ─────────────────────────────────────    │
│  지도에서 보기                              │
│    ┌─────────────────────────────────┐    │
│    │    🚻 🚻   🚻                   │    │
│    │  🚻     🚻                      │    │
│    │       🚻   🚻                   │    │
│    └─────────────────────────────────┘    │
│                                            │
│  ─────────────────────────────────────    │
│  목록                                      │
│  ─────────────────────────────────────    │
│                                            │
│  🚻 강남역 공중화장실                       │
│     서울시 강남구 강남대로 396              │
│                                            │
│  🚻 신논현역 공중화장실                     │
│     서울시 강남구 봉은사로 ...              │
│                                            │
│  ... (전체 목록)                           │
│                                            │
│  ─────────────────────────────────────    │
│  다른 카테고리                              │
│  [쓰레기 배출] [무료 와이파이]              │
│                                            │
│  ─────────────────────────────────────    │
│  주변 지역                                  │
│  [서초구] [송파구] [용산구]                 │
└────────────────────────────────────────────┘
```

---

## 상태 전이 다이어그램

```
                    ┌──────────────┐
                    │    시작      │
                    └──────┬───────┘
                           │
           ┌───────────────┼───────────────┐
           │               │               │
           ▼               ▼               ▼
    ┌──────────┐    ┌──────────┐    ┌──────────┐
    │ 검색엔진 │    │ 직접방문 │    │ 공유링크 │
    │  유입    │    │          │    │          │
    └────┬─────┘    └────┬─────┘    └────┬─────┘
         │               │               │
         ▼               ▼               ▼
    ┌──────────┐    ┌──────────┐    ┌──────────┐
    │ 지역별   │    │ 메인     │    │ 상세     │
    │ 페이지   │    │ 페이지   │    │ 페이지   │
    └────┬─────┘    └────┬─────┘    └────┬─────┘
         │               │               │
         │         ┌─────┴─────┐         │
         │         │           │         │
         │         ▼           ▼         │
         │    ┌──────────┐ ┌──────────┐  │
         ├───▶│ 검색결과 │ │ 위치기반 │◀─┤
         │    │ 페이지   │ │ 검색    │  │
         │    └────┬─────┘ └────┬─────┘  │
         │         │           │         │
         │         └─────┬─────┘         │
         │               │               │
         │               ▼               │
         │         ┌──────────┐          │
         └────────▶│ 상세     │◀─────────┘
                   │ 페이지   │
                   └────┬─────┘
                        │
                        ▼
                   ┌──────────┐
                   │ 길찾기   │
                   │ (외부)   │
                   └──────────┘
```

---

## 에러 처리 흐름

### 위치 권한 거부
```
위치 권한 요청
       │
   거부됨
       │
       ▼
┌─────────────────────────┐
│ "위치 권한이 필요합니다" │
│                         │
│ [수동으로 지역 선택]    │
└─────────────────────────┘
       │
       ▼
지역 선택 모달 표시
```

### 검색 결과 없음
```
검색 결과 0건
       │
       ▼
┌─────────────────────────┐
│ "검색 결과가 없습니다"   │
│                         │
│ - 다른 검색어 추천      │
│ - 검색 범위 확대 제안   │
└─────────────────────────┘
```

### API 오류
```
API 요청 실패
       │
       ▼
┌─────────────────────────┐
│ "일시적인 오류입니다"    │
│                         │
│ [다시 시도]             │
└─────────────────────────┘
```
